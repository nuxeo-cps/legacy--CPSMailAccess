<html metal:use-macro="here/main_template/macros/master">
  <metal:block fill-slot="css_slot">
    <style type="text/css" media="all"
      tal:content="string:@import url(${context/portal_url}/++resource++cpsmailaccess.css);"/>
  </metal:block>

  <metal:main fill-slot="javascript_head_slot">
    <script type="text/javascript"
      tal:attributes="src string:${context/portal_url}/++resource++pdlib.js;"
      src="++resource++pdlib.js">
    </script>
    <script type="text/javascript"
      tal:attributes="src string:${context/portal_url}/++resource++sorttable.js;"
      src="++resource++sorttable.js">
    </script>
    <script type="text/javascript"
      tal:attributes="src string:${context/portal_url}/++resource++cpsmailaccess.js;"
      src="++resource++cpsmailaccess.js">
    </script>
  </metal:main>
  <metal:block metal:fill-slot="main"
               tal:define="show_folder request/showfolders|python:0;
                           synchro python:here.getMailBox().isSynchronizing();
                           content_managment request/content_managment|nothing;">
    <div class="message" tal:condition="synchro" i18n:translate="cps_synchronizing">
    While the box is beeing synchronized, webmail features are limited to browsing.
    </div>
    <metal:block use-macro="here/messagelist_macros/mailbox_warning"/>
    <metal:block use-macro="here/messagelist_macros/actions_toolbar"/>
    <div tal:condition="show_folder"
         tal:define="is_folder python:0">
      <metal:block use-macro="here/messagelist_macros/messagelist"/>
      <script langage="javascript">
        truncateFields(32);
      </script>
    </div>
    <div class="spacer"></div>
    <div class="mailHeaders">
      <metal:block use-macro="here/messagelist_macros/messagetoolbar"/>
      <metal:block use-macro="here/messagelist_macros/messageheaders"/>
    </div>
    <div id="mailBody">
      <tal:block tal:replace="structure view/renderBody"/>
    </div>
  </metal:block>
</html>
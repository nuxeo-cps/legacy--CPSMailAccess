<html metal:use-macro="here/main_template/macros/master">
  <metal:block fill-slot="css_slot">
    <style type="text/css" media="all"
      tal:content="string:@import url(${context/portal_url}/++resource++cpsmailaccess.css);"/>
  </metal:block>
  <metal:main fill-slot="javascript_head_slot">
    <script type="text/javascript"
      tal:attributes="src string:${context/portal_url}/++resource++cpsmailaccess.js;"
      src="++resource++cpsmailaccess.js">
    </script>
  </metal:main>
  <metal:block metal:fill-slot="main">
    <form action="searchMessage.html">
      <input type="text" name="searchable_text"/>
      <input type="submit" name="search_submitted" value="search"/>
     </form>

    <tal:block tal:condition="request/search_submitted|python:0">
        <tal:block tal:define="searchable_text request/searchable_text|python:'';
                               results python:here.searchMessages(searchable_text)">
         todo : a mettre en forme
            <div tal:repeat="result results">
              <tal:block tal:define="mail_path python:result['path']+'/view'">
                <a tal:attributes="href mail_path">
                  <tal:block replace="mail_path"/>
                </a>
              </tal:block>
            </div>
        </tal:block>
    </tal:block>
  </metal:block>
</html>
